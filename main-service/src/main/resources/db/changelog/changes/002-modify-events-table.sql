-- liquibase formatted sql

-- changeset belov:002-add-event-fields
CREATE TABLE IF NOT EXISTS locations
(
    id  BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    lat FLOAT NOT NULL,
    lon FLOAT NOT NULL
);

ALTER TABLE events
    ADD COLUMN IF NOT EXISTS annotation TEXT NOT NULL,
    ADD COLUMN IF NOT EXISTS title VARCHAR(125) NOT NULL,
    ADD COLUMN IF NOT EXISTS description TEXT,
    ADD COLUMN IF NOT EXISTS confirmed_requests BIGINT,
    ADD COLUMN IF NOT EXISTS created_on TIMESTAMP NOT NULL,
    ADD COLUMN IF NOT EXISTS event_date TIMESTAMP NOT NULL,
    ADD COLUMN IF NOT EXISTS paid BOOLEAN DEFAULT FALSE,
    ADD COLUMN IF NOT EXISTS participant_limit BIGINT DEFAULT 0,
    ADD COLUMN IF NOT EXISTS published_on TIMESTAMP NOT NULL,
    ADD COLUMN IF NOT EXISTS request_moderation BOOLEAN DEFAULT TRUE,
    ADD COLUMN IF NOT EXISTS category_id BIGINT,
    ADD COLUMN IF NOT EXISTS initiator_id BIGINT,
    ADD COLUMN IF NOT EXISTS location_id BIGINT,
    ADD COLUMN IF NOT EXISTS state VARCHAR(21),
    ADD COLUMN IF NOT EXISTS views BIGINT,
    ADD CONSTRAINT fk_events_category FOREIGN KEY (category_id) REFERENCES categories (id),
    ADD CONSTRAINT fk_events_location FOREIGN KEY (location_id) REFERENCES locations (id);